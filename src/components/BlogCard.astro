---
interface Props {
  title: string;
  description: string;
  image: string;
  category: string;
  author: {
    name: string;
    image: string;
  };
  publishDate: string;
  readingTime: number;
  href: string;
}

const {
  title,
  description,
  image,
  category,
  author,
  publishDate,
  readingTime,
  href
} = Astro.props;

const formattedDate = new Date(publishDate).toLocaleDateString('fr-FR', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});
---

<article class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden">
  <a href={href} class="block">
    <img
      src={image}
      alt={title}
      class="w-full h-48 object-cover"
      loading="lazy"
    />
  </a>
  
  <div class="p-6">
    <div class="flex items-center space-x-2 mb-4">
      <span class="text-sm font-medium text-blue-600 dark:text-blue-400">
        {category}
      </span>
      <span class="text-gray-300 dark:text-gray-600">â€¢</span>
      <span class="text-sm text-gray-600 dark:text-gray-400">
        {readingTime} min de lecture
      </span>
    </div>
    
    <h2 class="text-xl font-bold mb-2">
      <a
        href={href}
        class="text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400"
      >
        {title}
      </a>
    </h2>
    
    <p class="text-gray-600 dark:text-gray-300 mb-4">
      {description}
    </p>
    
    <div class="flex items-center">
      <img
        src={author.image}
        alt={author.name}
        class="w-10 h-10 rounded-full mr-4"
        loading="lazy"
      />
      <div>
        <p class="text-sm font-medium text-gray-900 dark:text-white">
          {author.name}
        </p>
        <p class="text-sm text-gray-600 dark:text-gray-400">
          {formattedDate}
        </p>
      </div>
    </div>
  </div>
</article>

<script define:vars={{ title, description, author, publishDate, category, href }}>
  // Schema.org article
  const schema = {
    '@context': 'https://schema.org',
    '@type': 'BlogPosting',
    'headline': title,
    'description': description,
    'author': {
      '@type': 'Person',
      'name': author.name
    },
    'datePublished': publishDate,
    'articleSection': category,
    'url': new URL(href, Astro.site).href
  };

  const script = document.createElement('script');
  script.setAttribute('type', 'application/ld+json');
  script.textContent = JSON.stringify(schema);
  document.head.appendChild(script);
</script> 